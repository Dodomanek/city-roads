webpackJsonp([1],{"+syb":function(e,t){},Jmh0:function(e,t){},LVrL:function(e,t,n){var o=n("/5HI"),i=n("MeRj").place;e.exports=function(e){var t=[],n=[],r=(new Date).toISOString();e.forEachElement(function(e){"node"===e.type?t.push(e):"way"===e.type&&n.push(e)});var a=new o;return i.write({version:1,id:e.id,date:r,name:e.name,nodes:t,ways:n},a),a.finish()}},MeRj:function(e,t,n){"use strict";var o=t.place={};o.read=function(e,t){return e.readFields(o._readField,{version:0,name:"",date:"",id:"",nodes:[],ways:[]},t)},o._readField=function(e,t,n){1===e?t.version=n.readVarint():2===e?t.name=n.readString():3===e?t.date=n.readString():4===e?t.id=n.readString():5===e?t.nodes.push(o.node.read(n,n.readVarint()+n.pos)):6===e&&t.ways.push(o.way.read(n,n.readVarint()+n.pos))},o.write=function(e,t){if(e.version&&t.writeVarintField(1,e.version),e.name&&t.writeStringField(2,e.name),e.date&&t.writeStringField(3,e.date),e.id&&t.writeStringField(4,e.id),e.nodes)for(var n=0;n<e.nodes.length;n++)t.writeMessage(5,o.node.write,e.nodes[n]);if(e.ways)for(n=0;n<e.ways.length;n++)t.writeMessage(6,o.way.write,e.ways[n])},o.node={},o.node.read=function(e,t){return e.readFields(o.node._readField,{id:0,lat:0,lon:0},t)},o.node._readField=function(e,t,n){1===e?t.id=n.readVarint():2===e?t.lat=n.readFloat():3===e&&(t.lon=n.readFloat())},o.node.write=function(e,t){e.id&&t.writeVarintField(1,e.id),e.lat&&t.writeFloatField(2,e.lat),e.lon&&t.writeFloatField(3,e.lon)},o.way={},o.way.read=function(e,t){return e.readFields(o.way._readField,{nodes:[]},t)},o.way._readField=function(e,t,n){1===e&&n.readPackedVarint(t.nodes)},o.way.write=function(e,t){e.nodes&&t.writePackedVarint(1,e.nodes)}},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("7+uW"),i=n("gBtx"),r=n.n(i),a=n("c/Tr"),s=n.n(a),l=n("AMV0"),c=n.n(l),d=n("5dBV"),u=n.n(d),h={render:function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{staticClass:"loader",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",width:"12",height:"12",fill:"black"}},[t("path",{attrs:{opacity:".25",d:"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4"}}),this._v(" "),t("path",{attrs:{d:"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z"}},[t("animateTransform",{attrs:{attributeName:"transform",type:"rotate",from:"0 16 16",to:"360 16 16",dur:"0.8s",repeatCount:"indefinite"}})],1)])},staticRenderFns:[]},f=n("VU/8")(null,h,!1,null,null,null).exports,p=n("fZjL"),v=n.n(p),g=n("//Fk"),m=n.n(g);function w(e,t){t||(t={});var n=void 0,o=t.progress||{};return o.on&&o.onCancel(i),new m.a(function(r,a){n=new XMLHttpRequest,"function"==typeof o.notify&&n.addEventListener("progress",function(e){e.lengthComputable?o.notify({loaded:e.loaded,total:e.total,percent:e.loaded/e.total,lengthComputable:!0}):o.notify({loaded:e.loaded,lengthComputable:!1})},!1);n.addEventListener("load",function(){if(o.offCancel(i),!o.isCancelled)if(200===n.status){var s=n.response;"json"===t.responseType&&"string"==typeof s&&(s=JSON.parse(s)),setTimeout(function(){return r(s)},0)}else a({statusError:n.status,message:"Unexpected status code "+n.status+" when calling "+e})},!1),n.addEventListener("error",function(){a("Failed to download "+e)},!1),n.addEventListener("abort",function(){a({cancelled:!0,message:"Cancelled download of "+e})},!1),n.open(t.method||"GET",e),t.responseType&&(n.responseType=t.responseType);t.headers&&v()(t.headers).forEach(function(e){n.setRequestHeader(e,t.headers[e])});"POST"===t.method?n.send(t.body):n.send(null)});function i(){!0,n&&n.abort()}}var b=["https://overpass.kumi.systems/api/interpreter","https://overpass-api.de/api/interpreter","https://overpass.openstreetmap.ru/cgi/interpreter"];var y=n("3zJd"),_=n.n(y)()({},{useSearch:!0}),k={drawLabels:!0,backgroundColor:{r:247,g:242,b:232,a:1},lineColor:{r:22,g:22,b:22,a:1},labelColor:{r:22,g:22,b:22,a:1},get:function(){return _.get.apply(_,arguments)},set:function(){return _.set.apply(_,arguments)},unset:function(){return _.unset.apply(_,arguments)},unsetPlace:function(){_.unset("areaId"),_.unset("osm_id"),_.unset("bbox")}},C=n("ifoU"),x=n.n(C),L=n("Zrlr"),F=n.n(L),S=n("wxAW"),P=n.n(S),E=function(){function e(){F()(this,e),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}return P()(e,[{key:"growBy",value:function(e){this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e}},{key:"addPoint",value:function(e,t){if(void 0===e)throw new Error("Point is not defined");var n=e,o=t;void 0===o&&(n=e.x,o=e.y),n<this.minX&&(this.minX=n),n>this.maxX&&(this.maxX=n),o<this.minY&&(this.minY=o),o>this.maxY&&(this.maxY=o)}},{key:"addRect",value:function(e){if(!e)throw new Error("rect is not defined");this.addPoint(e.left,e.top),this.addPoint(e.right,e.top),this.addPoint(e.left,e.bottom),this.addPoint(e.right,e.bottom)}},{key:"merge",value:function(e){e.minX<this.minX&&(this.minX=e.minX),e.minY<this.minY&&(this.minY=e.minY),e.maxX>this.maxX&&(this.maxX=e.maxX),e.maxY>this.maxY&&(this.maxY=e.maxY)}},{key:"left",get:function(){return this.minX}},{key:"top",get:function(){return this.minY}},{key:"right",get:function(){return this.maxX}},{key:"bottom",get:function(){return this.maxY}},{key:"width",get:function(){return this.maxX-this.minX}},{key:"height",get:function(){return this.maxY-this.minY}},{key:"cx",get:function(){return(this.minX+this.maxX)/2}},{key:"cy",get:function(){return(this.minY+this.maxY)/2}}]),e}(),R=n("qC7P"),T=function(){function e(){F()(this,e),this.elements=[],this.bounds=new E,this.nodes=new x.a,this.wayPointCount=0,this.id=0,this.name="",this.isArea=!0,this.projector=Object(R.a)()}return P()(e,[{key:"setName",value:function(e){this.name=e}},{key:"setId",value:function(e){this.id=e}},{key:"setIsArea",value:function(e){this.isArea=e}},{key:"setBBox",value:function(e){this.bboxString=e}},{key:"getProjectedRect",value:function(){var e=this.bounds,t=this.getProjector(),n=t({lon:e.left,lat:e.bottom}),o=t({lon:e.right,lat:e.top}),i=n.x,r=n.y,a=o.y,s=o.x;return{left:i,top:r,right:s,bottom:a,width:s-i,height:Math.abs(a-r)}}},{key:"forEachElement",value:function(e){this.elements.forEach(e)}},{key:"forEachWay",value:function(e){var t=this.nodes,n=this.getProjector();this.elements.forEach(function(o){if("way"===o.type)for(var i=o.nodes,r=n(t.get(i[0])),a=1;a<i.length;++a){var s=n(t.get(i[a]));e(r,s),r=s}})}},{key:"getProjector",value:function(){var e=[0,0],t=this.projector;return function(n){var o=n.lon,i=n.lat;e[0]=o,e[1]=i;var r=t(e);return{x:r[0],y:r[1]}}}}],[{key:"fromPBF",value:function(t){if(1!==t.version)throw new Error("Unknown version "+t.version);var n=[];t.nodes.forEach(function(e){e.type="node",n.push(e)}),t.ways.forEach(function(e){e.type="way",n.push(e)});var o=e.fromOSMResponse(n);return o.setName(t.name),o.setId(t.id),o}},{key:"fromOSMResponse",value:function(t){var n=new e,o=n.nodes,i=n.bounds,r=0;return t.forEach(function(e){"node"===e.type?(o.set(e.id,e),i.addPoint(e.lon,e.lat)):"way"===e.type&&(r+=e.nodes.length)}),n.elements=t,n.projector.center([i.cx,i.cy]).scale(6371393),n.wayPointCount=r,n}}]),e}(),z="https://anvaka.github.io/index-large-cities/data",I=n("puH/"),B=n.n(I),A=function(){function e(t){F()(this,e),B()(this),this.callback=t}return P()(e,[{key:"cancel",value:function(){this.isCancelled=!0,this.fire("cancel")}},{key:"notify",value:function(e){this.isCancelled||this.callback(e)}},{key:"onCancel",value:function(e){this.on("cancel",e,this)}},{key:"offCancel",value:function(e){this.off("cancel",e)}}]),e}(),j={name:"FindPlace",components:{LoadingIcon:f},data:function(){var e=k.get("q")||"",t=O();return{enteredInput:e,loading:null,lastCancel:null,suggestionsLoaded:!1,stillLoading:0,error:null,hideInput:!1,noRoads:!1,clicked:!1,showWarning:t,mainActionText:t?"Download Area":"Find City Bounds",data:[]}},watch:{enteredInput:function(){this.mainActionText="Find City Bounds",this.showWarning=!1,this.hideInput=!1,k.unsetPlace()}},mounted:function(){this.$refs.input.focus()},beforeDestroy:function(){this.lastCancel&&this.lastCancel(),clearInterval(this.notifyStillLoading)},methods:{onSubmit:function(){var e=this;k.set("q",this.enteredInput),this.cancelRequest(),this.data=[],this.noRoads=!1,this.error=!1,this.showWarning=!1;var t=O(this.enteredInput);if(t)this.pickSuggestion(t);else{var n=encodeURIComponent(this.enteredInput);this.loading="Searching cities that match your query...",fetch("https://nominatim.openstreetmap.org/search?format=json&q="+n).then(function(e){return e.json()}).then(function(e){return e.map(function(e){return"relation"===e.osm_type?{name:e.display_name,type:e.type,areaId:e.osm_id+36e8}:e.boundingbox?{name:e.display_name,type:e.type,osm_id:e.osm_id,bbox:[u()(e.boundingbox[0]),u()(e.boundingbox[2]),u()(e.boundingbox[1]),u()(e.boundingbox[3])]}:void 0}).filter(function(e){return e})}).then(function(t){e.loading=null,e.suggestionsLoaded=!0,e.data=t,e.hideInput=t&&t.length})}},updateProgress:function(e){if(this.stillLoading=0,clearInterval(this.notifyStillLoading),e.loaded<0)return this.loading="Trying a different server",void this.restartLoadingMonitor();void 0!==e.percent?this.loading="Loaded "+Math.round(100*e.percent)+"% ("+U(e.loaded)+" bytes)...":this.loading="Loaded "+U(e.loaded)+" bytes..."},pickSuggestion:function(e){var t=this;this.error=!1,e.areaId?this.checkCache(e).catch(function(n){if(!n.cancelled)return t.useOSM(e)}):this.useOSM(e)},restartLoadingMonitor:function(){var e=this;clearInterval(this.notifyStillLoading),this.stillLoading=0,this.notifyStillLoading=setInterval(function(){e.stillLoading++},1e4)},checkCache:function(e){var t=this;this.loading="Checking cache...";var o=e.areaId;return w(z+"/"+o+".pbf",{progress:this.generateNewProgressToken(),responseType:"arraybuffer"}).then(function(e){return new Uint8Array(e)}).then(function(e){var o=n("/5HI"),i=n("MeRj").place,r=new o(e),a=i.read(r),s=T.fromPBF(a);t.$emit("loaded",s)})},useOSM:function(e){var t=this;if(e.areaId&&e.osm_id)throw new Error("Cannot have both area id and osm id. Pick one");this.loading="Connecting to OpenStreetMap...",this.restartLoadingMonitor(),function(e,t){var n={method:"POST",responseType:"json",progress:t,headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:"data="+encodeURIComponent(e)},o=0;return i(b[o]);function i(e){return w(e,n).catch(r)}function r(e){if(e.cancelled)throw e;if(o>=b.length-1)throw e;return e.statusError&&t.notify({loaded:-1}),i(b[o+=1])}}(function(e){var t=e.areaId;if(t)return"[timeout:9000][maxsize:2000000000][out:json];\narea("+t+');\n(._; )->.area;\n(\nway["highway"](area.area);\nnode(w);\n);\nout skel;';var n=M(e.bbox);return"[timeout:9000][maxsize:2000000000][out:json][bbox:"+n+'];\n(\nway["highway"];\nnode(w);\n);\nout skel('+n+");"}(e),this.generateNewProgressToken()).then(function(n){if(t.loading=null,0!==n.elements.length){var o=T.fromOSMResponse(n.elements);o.setName(e.name),o.setId(e.areaId||e.osm_id),o.setIsArea(e.areaId),o.setBBox(M(e.bbox)),t.$emit("loaded",o)}else t.noRoads=!0}).catch(function(e){e.cancelled?t.loading=null:(console.error(e),t.error=e,t.loading=null,t.data=[])}).finally(function(){clearInterval(t.notifyStillLoading),t.stillLoading=0})},cancelRequest:function(){this.progressToken&&(this.progressToken.cancel(),this.progressToken=null,this.loading=!1)},generateNewProgressToken:function(){return this.progressToken&&(this.progressToken.cancel(),this.progressToken=null),this.progressToken=new A(this.updateProgress),this.progressToken}}};function M(e){return e&&e.join(",")}function U(e){return c()(e)?e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"N/A"}function O(e){var t=function(){var e=k.get("areaId");c()(r()(e,10))||(e=null);return e}();if(t)return{name:e,areaId:t};var n=function(){var e=k.get("osm_id");if(!c()(r()(e,10)))return;var t=function(e){if(!e)return null;var t=e.split(",").map(function(e){return u()(e)}).filter(function(e){return c()(e)});return 4===t.length?t:null}(k.get("bbox"));if(!t)return;return{osm_id:e,bbox:t}}();return n?{name:e,osm_id:n.osm_id,bbox:n.bbox}:void 0}var Y={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"find-place",class:{centered:!e.suggestionsLoaded}},[e.suggestionsLoaded?e._e():n("div",[n("h3",{staticClass:"site-header"},[e._v("city roads")]),e._v(" "),n("p",{staticClass:"description"},[e._v("This website renders every single road within a city")])]),e._v(" "),n("form",{staticClass:"search-box",on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.enteredInput,expression:"enteredInput"}],ref:"input",staticClass:"query-input",attrs:{type:"text",placeholder:"Enter a city name to start"},domProps:{value:e.enteredInput},on:{input:function(t){t.target.composing||(e.enteredInput=t.target.value)}}}),e._v(" "),e.enteredInput&&!e.hideInput?n("a",{staticClass:"search-submit",attrs:{type:"submit",href:"#"},on:{click:function(t){return t.preventDefault(),e.onSubmit(t)}}},[e._v(e._s(e.mainActionText))]):e._e()]),e._v(" "),e.showWarning?n("div",{staticClass:"prompt message note shadow"},[e._v("\n    Note: Large cities may require 200MB+ of data transfer and may need a powerful device to render.\n  ")]):e._e(),e._v(" "),e.loading?e._e():n("div",{staticClass:"results"},[e.suggestionsLoaded&&e.data.length?n("div",{staticClass:"suggestions shadow"},[e._m(0),e._v(" "),n("ul",e._l(e.data,function(t,o){return n("li",{key:o},[n("a",{staticClass:"suggestion",attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),e.pickSuggestion(t)}}},[n("span",[e._v("\n          "+e._s(t.name)+" "),n("small",[e._v("("+e._s(t.type)+")")])])])])}),0)]):e._e(),e._v(" "),!e.suggestionsLoaded||e.data.length||e.loading?e._e():n("div",{staticClass:"no-results message shadow"},[e._v("\n      Didn't find matching cities. Try a different query?\n    ")]),e._v(" "),e.noRoads?n("div",{staticClass:"no-results message shadow"},[e._v("\n      Didn't find any roads. Try a different query?\n    ")]):e._e()]),e._v(" "),e.error?n("div",{staticClass:"error message shadow"},[n("div",[e._v("Something went wrong. The error was:")]),e._v(" "),n("pre",[e._v(e._s(e.error))])]):e._e(),e._v(" "),e.loading?n("div",{staticClass:"loading message shadow"},[n("loading-icon"),e._v(" "),n("span",[e._v(e._s(e.loading))]),e._v(" "),n("a",{staticClass:"cancel-request",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.cancelRequest(t)}}},[e._v("cancel")]),e._v(" "),e.stillLoading>0?n("div",{staticClass:"load-padding"},[e._v("\n      Still loading...\n    ")]):e._e(),e._v(" "),e.stillLoading>1?n("div",{staticClass:"load-padding"},[e._v("\n      Sorry it takes so long!\n    ")]):e._e()],1):e._e()])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"prompt message"},[t("div",[this._v("Select boundaries below to download all roads within")]),this._v(" "),t("div",{staticClass:"note"},[this._v("large cities may require 200MB+ of data transfer and a powerful device")])])}]};var V=n("VU/8")(j,Y,!1,function(e){n("Jmh0")},null,null).exports,W=[],D="@@clickoutsideContext",N=void 0,G=0;function H(e,t,n){return function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n&&n.context&&o.target&&i.target&&!e.contains(o.target)&&!e.contains(i.target)&&e!==o.target&&(!n.context.popperElm||!n.context.popperElm.contains(o.target)&&!n.context.popperElm.contains(i.target))){var r=e[D].methodName;t.expression&&r&&n.context[r]?n.context[r]():e[D].bindingFn&&e[D].bindingFn()}}}document.addEventListener("mousedown",function(e){return N=e},!0),document.addEventListener("mouseup",function(e){W.forEach(function(t){return t[D].documentHandler(e,N)})},!0),document.addEventListener("touchstart",function(e){N=e},!0),document.addEventListener("touchend",function(e){W.forEach(function(t){return t[D].documentHandler(e,N)})},!0);var X={bind:function(e,t,n){W.push(e);var o=G++;e[D]={id:o,documentHandler:H(e,t,n),methodName:t.expression,bindingFn:t.value}},update:function(e,t,n){e[D].documentHandler=H(e,t,n),e[D].methodName=t.expression,e[D].bindingFn=t.value},unbind:function(e){for(var t=W.length,n=0;n<t;n++)if(W[n][D].id===e[D].id){W.splice(n,1);break}delete e[D]}},q={name:"EditableLabel",props:["value","printable"],directives:{ClickOutside:X},methods:{looseFocus:function(){this.$refs.input.blur()}}},$={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.looseFocus,expression:"looseFocus"}]},[n("div",{staticClass:"editable-label"},[n("span",{class:{printable:e.printable}},[e._v(e._s(e.value))]),e._v(" "),n("input",{ref:"input",domProps:{value:e.value},on:{input:function(t){return e.$emit("input",t.target.value)}}})])])},staticRenderFns:[]};var J=n("VU/8")(q,$,!1,function(e){n("+syb")},null,null).exports,Z=n("YrBu"),K=n.n(Z),Q=n("Zzkc"),ee={name:"vue-colorpicker",components:{"sketch-picker":Q.Sketch},directives:{ClickOutside:X},props:{value:{type:Object}},data:function(){return{showPicker:!1,colors:{hex:"#FFFFFF",a:1},colorValue:"#FFFFFF",panelLeft:"0px",panelTop:"0px"}},computed:{pickerType:function(){return"sketch-picker"},isTransparent:function(){return 0===this.colors.a},btnStyle:function(){if(this.isTransparent)return{background:"#eee",backgroundImage:"linear-gradient(45deg, rgba(0,0,0,.25) 25%, transparent 0, transparent 75%,rgba(0,0,0,.25)0), linear-gradient(45deg, rgba(0,0,0,.25)25%,transparent 0, transparent 75%,rgba(0,0,0,.25)0)",backgroundPosition:"0 0, 11px 11px",backgroundSize:"22px 22px"};var e=this.colorValue;return{background:"rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"}}},watch:{value:function(e,t){e!==t&&this.updateColorObject(e)},showPicker:function(e){if(e){var t=this.$refs.triggerButton.getBoundingClientRect(),n=t.x,o=t.bottom;t.y+320>window.innerHeight&&(o=Math.max(0,window.innerHeight-320),n+=36),n+220>window.innerWidth&&(n=Math.max(0,window.innerWidth-220)),this.panelLeft=n+"px",this.panelTop=o+"px"}}},methods:{hide:function(){this.showPicker=!1},changeColor:function(e){this.colorValue=e.rgba,this.$emit("input",this.colorValue),this.$emit("change",this.colorValue)},updateColorObject:function(e){if(e){var t=K()("rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"||"transparent");this.colors=e&&"transparent"!==e?{hex:t.toHexString(),hsl:t.toHsl(),hsv:t.toHsv(),rgba:t.toRgb(),a:t.getAlpha()}:{hex:"#FFFFFF",hsl:{h:0,s:0,l:1,a:0},hsv:{h:0,s:0,v:1,a:0},rgba:{r:255,g:255,b:255,a:0},a:0},this.colorValue=this.colors.rgba}}},mounted:function(){this.updateColorObject(this.value)}},te={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.hide,expression:"hide"}],staticClass:"vue-colorpicker",on:{click:function(t){e.showPicker=!0}}},[n("span",{ref:"triggerButton",staticClass:"vue-colorpicker-btn",style:e.btnStyle}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showPicker,expression:"showPicker"}],staticClass:"vue-colorpicker-panel",style:{left:e.panelLeft,top:e.panelTop}},[n(e.pickerType,{tag:"component",on:{input:e.changeColor},model:{value:e.colors,callback:function(t){e.colors=t},expression:"colors"}})],1)])},staticRenderFns:[]};var ne=n("VU/8")(ee,te,!1,function(e){n("om41")},"data-v-60c70430",null).exports,oe=n("vkLu");function ie(e,t){var n=oe.scene(t);n.setClearColor(247/255,242/255,232/255,1);var o,i,r,a,s=(o=e.getProjectedRect(),i=o.width,r=o.height,{left:-(a=Math.max(i,r)/4),top:-a,right:a,bottom:a});n.setViewBox(s);var l=!1,c=function(){var t=void 0;t=new oe.WireCollection(e.wayPointCount),e.forEachWay(function(e,n){t.add({from:e,to:n})});return t.color={r:.1,g:.1,b:.1,a:.8},t}();return n.appendChild(c),document.addEventListener("keydown",d,!0),document.addEventListener("keyup",u,!0),{render:function(){n.renderFrame(!0)},getProjectedVisibleRect:function(){var e=n.getSceneCoordinate(0,0),t=n.getSceneCoordinate(window.innerWidth,window.innerHeight),o={left:e.x,top:e.y,right:t.x,bottom:t.y};return o.width=o.right-o.left,o.height=o.bottom-o.top,o},dispose:function(){n.clear(),n.dispose(),document.removeEventListener("keydown",d,!0),document.removeEventListener("keyup",u,!0)},setLineColor:function(e){c.color={r:e.r/255,g:e.g/255,b:e.b/255,a:e.a},n.renderFrame()},setBackground:function(e){n.setClearColor(e.r/255,e.g/255,e.b/255,e.a),n.renderFrame()}};function d(e){e.shiftKey&&(l=!0,n.getPanzoom().setZoomSpeed(.1))}function u(e){!e.shiftKey&&l&&(n.getPanzoom().setZoomSpeed(1),l=!1)}}var re="https://edi6jgnosf.execute-api.us-west-2.amazonaws.com/Stage/put_image",ae={mug:"168739066664861503"};function se(e){var t=e.toDataURL("image/png").replace(/^data:image\/(png|jpg);base64,/,""),n=new FormData;return n.append("image",t),w(re,{method:"POST",responseType:"json",progress:new A(Function.prototype),body:n}).then(function(e){if(!e.success)throw new Error("Failed to upload image");return function(e,t){var n=ae[e];if(!n)throw new Error("Unknown product kind: "+e);return"https://www.zazzle.com/api/create/at-238058511445368984?rf=238058511445368984&ax=Linkover&pd="+n+"&ed=true&tc=&ic=&t_map_iid="+encodeURIComponent(t)}("mug",e.data.link)}).catch(function(e){throw console.log("error",e),e})}var le=n("LVrL"),ce=n.n(le),de=n("kfvp"),ue=n.n(de),he=(n("YzTF"),void 0),fe={name:"App",components:{FindPlace:V,LoadingIcon:f,EditableLabel:J,ColorPicker:ne},data:function(){return{placeFound:!1,name:"",zazzleLink:null,generatingPreview:!1,showPrintWindow:!1,settingsOpen:!1,isPowerMode:k.get("svg"),lineColor:k.lineColor,labelColor:k.labelColor,backgroundColor:k.backgroundColor}},computed:{labelColorRGBA:function(){return ve(this.labelColor)}},beforeDestroy:function(){this.dispose()},methods:{dispose:function(){this.scene&&this.scene.dispose()},togglePrintWindow:function(){this.showPrintWindow=!this.showPrintWindow},onGridLoaded:function(e){e.isArea?(k.set("areaId",e.id),k.unset("osm_id"),k.unset("bbox")):e.bboxString&&(k.unset("areaId"),k.set("osm_id",e.id),k.set("bbox",e.bboxString)),this.placeFound=!0,this.name=e.name.split(",")[0],he=e;var t=ge();t.style.visibility="visible",this.scene=ie(e,t)},startOver:function(){k.unset("areaId"),k.unsetPlace(),k.unset("q"),this.dispose(),this.placeFound=!1,this.zazzleLink=null,this.showPrintWindow=!1;var e={r:247,g:242,b:232,a:1};this.backgroundColor=e,this.lineColor={r:22,g:22,b:22,a:1},this.labelColor={r:22,g:22,b:22,a:1},document.body.style.backgroundColor=ve(e),ge().style.visibility="hidden"},toFile:function(e){var t=this.getPrintableCanvas(),n=this.getFileName();t.toBlob(function(e){var t=window.URL.createObjectURL(e),o=document.createElement("a");o.href=t,o.download=n+".png",o.click(),window.URL.revokeObjectURL(t)},"image/png")},toSVGFile:function(e){if(he){var t=this.scene.getProjectedVisibleRect(),n=ue()(he,t,{stroke:me(this.lineColor),background:me(this.backgroundColor),labels:pe()}),o=new Blob([n],{type:"image/svg+xml"}),i=window.URL.createObjectURL(o),r=document.createElement("a");r.href=i,r.download=he.id+".svg",r.click(),window.URL.revokeObjectURL(i)}},getFileName:function(e){return(new Date).toISOString().replace(/[\s\W]/g,"_")+(e||"")},toProtobuf:function(e){if(he){var t=ce()(he),n=new Blob([t.buffer],{type:"application/octet-stream"}),o=window.URL.createObjectURL(n),i=document.createElement("a");i.href=o,i.download=he.id+".pbf",i.click(),window.URL.revokeObjectURL(o)}},updateLinesColor:function(){this.scene.setLineColor(this.lineColor)},updateBackground:function(){this.setBackgroundColor(this.backgroundColor)},setBackgroundColor:function(e){this.scene.setBackground(e),document.body.style.backgroundColor=ve(e)},zazzleMugPrint:function(){var e=this;if(this.zazzleLink)return window.open(this.zazzleLink,"_blank"),void be(this.zazzleLink);var t=this.getPrintableCanvas();this.generatingPreview=!0,se(t).then(function(t){e.zazzleLink=t,window.open(t,"_blank"),be(t),e.generatingPreview=!1}).catch(function(t){e.error=t,e.generatingPreview=!1})},getPrintableCanvas:function(){var e=ge(),t=e.width,n=e.height,o=document.createElement("canvas"),i=o.getContext("2d");return o.width=t,o.height=n,this.scene.render(),i.drawImage(e,0,0,e.width,e.height,0,0,t,n),k.drawLabels&&pe().forEach(function(e){!function(e,t){if(!e)return;t.save();var n=window.devicePixelRatio||1;t.font=n*e.fontSize+"px "+e.fontFamily,t.fillStyle=e.color,t.textAlign="end",t.fillText(e.text,e.bounds.right*n,e.bounds.bottom*n),t.restore()}(e,i)}),o}}};function pe(){return s()(document.querySelectorAll(".printable")).map(function(e){var t=window.getComputedStyle(e),n=e.getBoundingClientRect(),o=r()(t.fontSize,10);return{text:e.innerText,bounds:n,fontSize:o,color:t.color,fontFamily:t.fontFamily,fill:t.color}})}function ve(e){return"rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"}function ge(){return document.querySelector("#canvas")}function me(e){return"#"+we(e.r)+we(e.g)+we(e.b)}function we(e){if(0===e)return"00";var t=e.toString(16);return e<16?"0"+t:t}function be(e){"undefined"!=typeof ga&&ga("send","event",{eventCategory:"Outbound Link",eventAction:"click",eventLabel:e})}var ye={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.placeFound?e._e():n("find-place",{on:{loaded:e.onGridLoaded}}),e._v(" "),n("div",{attrs:{id:"app"}},[e.placeFound?n("div",[n("div",{staticClass:"controls"},[n("a",{staticClass:"print-button",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.togglePrintWindow(t)}}},[e._v("Customize...")]),e._v(" "),n("a",{staticClass:"try-another",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.startOver(t)}}},[e._v("Try another city")])]),e._v(" "),e.showPrintWindow?n("div",{staticClass:"print-window"},[n("h3",[e._v("Display")]),e._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[e._v("Colors")]),e._v(" "),n("div",{staticClass:"col colors c-2"},[n("div",{staticClass:"color-container"},[n("color-picker",{on:{change:e.updateLinesColor},model:{value:e.lineColor,callback:function(t){e.lineColor=t},expression:"lineColor"}}),e._v(" "),n("div",{staticClass:"color-label"},[e._v("lines")])],1),e._v(" "),n("div",{staticClass:"color-container"},[n("color-picker",{on:{change:e.updateBackground},model:{value:e.backgroundColor,callback:function(t){e.backgroundColor=t},expression:"backgroundColor"}}),e._v(" "),n("div",{staticClass:"color-label"},[e._v("background")])],1),e._v(" "),n("div",{staticClass:"color-container"},[n("color-picker",{model:{value:e.labelColor,callback:function(t){e.labelColor=t},expression:"labelColor"}}),e._v(" "),n("div",{staticClass:"color-label"},[e._v("labels")])],1)])]),e._v(" "),n("h3",[e._v("Export")]),e._v(" "),n("div",{staticClass:"row"},[n("a",{staticClass:"col",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.zazzleMugPrint()}}},[e._v("Onto a mug")]),e._v(" "),e._m(0)]),e._v(" "),n("div",{staticClass:"row"},[n("a",{staticClass:"col",attrs:{href:"#"},on:{"!click":function(t){return e.toFile(t)}}},[e._v("As an image (.png)")]),e._v(" "),n("span",{staticClass:"col c-2"},[e._v("\n            Save the current screen as a raster image.\n          ")])]),e._v(" "),n("div",{staticClass:"row"},[n("a",{staticClass:"col",attrs:{href:"#"},on:{"!click":function(t){return e.toSVGFile(t)}}},[e._v("As a vector (.svg)")]),e._v(" "),n("span",{staticClass:"col c-2"},[e._v("\n            Save the current roads on the screen as a vector image.\n          ")])]),e._v(" "),e._e(),e._v(" "),n("h3",[e._v("About")]),e._v(" "),e._m(1)]):e._e(),e._v(" "),e.zazzleLink||e.generatingPreview?n("div",{staticClass:"preview-actions message"},[e.zazzleLink?n("div",{staticClass:"padded popup-help"},[e._v("\n            If your browser has blocked the new window, "),n("br"),e._v("please "),n("a",{attrs:{href:e.zazzleLink,target:"_blank"}},[e._v("click here")]),e._v("\n            to open it.\n          ")]):e._e(),e._v(" "),e.generatingPreview?n("div",{staticClass:"loading-container"},[n("loading-icon"),e._v("\n            Generating preview url...\n          ")],1):e._e()]):e._e(),e._v(" "),n("editable-label",{staticClass:"city-name",style:{color:e.labelColorRGBA},attrs:{printable:!0},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),e._v(" "),n("div",{staticClass:"license printable",style:{color:e.labelColorRGBA}},[e._v("data "),n("a",{style:{color:e.labelColorRGBA},attrs:{href:"https://www.openstreetmap.org/about/",target:"_blank"}},[e._v("© OpenStreetMap")])])],1):e._e()])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"col c-2"},[this._v("\n            Print what you see onto a mug. "),t("br"),this._v("Get a unique gift of your favorite city.\n          ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("p",[e._v("This website was created by "),n("a",{attrs:{href:"https://twitter.com/anvaka",target:"_blank"}},[e._v("@anvaka")]),e._v(".\n          It downloads roads from OpenStreetMap and renders them with WebGL.\n          ")]),e._v(" "),n("p",[e._v("\n           You can find the entire "),n("a",{attrs:{href:"https://github.com/anvaka/city-roads"}},[e._v("source code here")]),e._v(". \n           If you love this website you can also "),n("a",{attrs:{href:"https://www.paypal.com/paypalme2/anvakos/3"}},[e._v("buy me a coffee")]),e._v(", but you don't have to!\n          ")])])}]};var _e=n("VU/8")(fe,ye,!1,function(e){n("uSY9")},null,null).exports,ke={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"absolute no-webgl"},[n("h3",[e._v("WebGL is not enabled :(")]),e._v(" "),n("p",[e._v("This website renders millions of roads at once.")]),e._v(" "),n("p",[e._v("\n    To render this amount of data fast, the website uses "),n("a",{attrs:{href:"https://get.webgl.org/"}},[e._v("WebGL")]),e._v(",\n    which seem to be not supported by the device that you are using.\n  ")]),e._v(" "),n("p",[e._v("Please try a different device to play with this website")]),e._v(" "),n("img",{attrs:{src:"https://i.imgur.com/Fbbe5a6.png",alt:"demo"}})])}]};var Ce=n("VU/8")(null,ke,!1,function(e){n("tvtY")},"data-v-4c133b01",null).exports,xe=n("vkLu");o.a.config.productionTip=!1,xe.isWebGLEnabled(document.querySelector("#canvas"))?new o.a({el:"#app",components:{App:_e},template:"<App/>"}):new o.a({el:"#app",components:{NoWebGL:Ce},template:"<NoWebGL/>"})},YzTF:function(e,t,n){"use strict";(function(e){var t=n("pFYg"),o=n.n(t);!function(t){var i=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,r=t.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),a=r&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),s=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,l=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,c=(r||s)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(e){var t,n,o,i,c,d,u,h,f;if(!(t=e.match(l)))throw new Error("invalid data URI");for(n=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),o=!!t[4],i=e.slice(t[0].length),c=o?atob(i):decodeURIComponent(i),d=new ArrayBuffer(c.length),u=new Uint8Array(d),h=0;h<c.length;h+=1)u[h]=c.charCodeAt(h);return r?new Blob([a?u:d],{type:n}):((f=new s).append(d),f.getBlob(n))};t.HTMLCanvasElement&&!i.toBlob&&(i.mozGetAsFile?i.toBlob=function(e,t,n){var o=this;setTimeout(function(){n&&i.toDataURL&&c?e(c(o.toDataURL(t,n))):e(o.mozGetAsFile("blob",t))})}:i.toDataURL&&c&&(i.toBlob=function(e,t,n){var o=this;setTimeout(function(){e(c(o.toDataURL(t,n)))})})),"function"==typeof define&&n("nErl")?define(function(){return c}):"object"===o()(e)&&e.exports?e.exports=c:t.dataURLtoBlob=c}(window)}).call(t,n("f1Eh")(e))},kfvp:function(e,t,n){n("MeRj").place;e.exports=function(e,t,n){(new Date).toISOString();var o=1/window.devicePixelRatio,i=['<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- Generator: https://github.com/anvaka/city-roads\nData © OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright\n--\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n   viewBox="'+t.left+" "+t.top+" "+t.width+" "+t.height+'">\n   <style>\n   path {\n    vector-effect: non-scaling-stroke;\n   }\n   </style>\n   <rect id="background" fill="'+n.background+'" x="'+t.left+'" y="'+t.top+'" width="'+t.width+'" height="'+t.height+'"></rect>\n'];return function(){i.push('<g id="paths" fill="none" stroke="'+n.stroke+'" stroke-width="'+o+'">');var r=e.nodes,a=e.getProjector();e.forEachElement(function(e){if("way"===e.type){var n=null,o=!1,s=e.nodes.map(function(e){var i=a(r.get(e));if(!function(e,t){return e.x<t.left||e.x>t.right||e.y<t.top||e.y>t.bottom}(i,t)){var s=null===n?"M":"L",l=s!==n;return"L"===s&&(o=!0),n=s,""+(l?s:"")+i.x+","+i.y}n=null}).filter(function(e){return e}).join(" ");o&&i.push('<path d="'+s+'" />')}}),i.push("</g>")}(),function(){window.innerWidth,t.width,window.innerHeight,t.height;n.labels.map(function(e){if(e.text){var n=e.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),o=e.bounds,i=t.width*o.right/window.innerWidth+t.left,r=t.height*o.bottom/window.innerHeight+t.top,a=t.height*e.fontSize/window.innerHeight,s=e.fontFamily.replace(/"/g,"'");return'<text text-anchor="end" x="'+i+'" y="'+r+'" fill="'+e.color+'" font-family="'+s+'" font-size="'+a+'">'+n+"</text>"}}).forEach(function(e){e&&i.push(e)})}(),i.push("</svg>"),i.join("\n")}},om41:function(e,t){},tvtY:function(e,t){},uSY9:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.18293d2abc9a0869f003.js.map